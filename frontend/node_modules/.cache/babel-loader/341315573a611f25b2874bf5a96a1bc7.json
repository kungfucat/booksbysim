{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\gurje\\\\Desktop\\\\new\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\gurje\\\\Desktop\\\\new\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\gurje\\\\Desktop\\\\new\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef,useState}from'react';import{LoadScript,GoogleMap,StandaloneSearchBox,Marker}from'@react-google-maps/api';import LoadingBox from'../components/LoadingBox';import Axios from'axios';import{USER_ADDRESS_MAP_CONFIRM}from'../constants/userConstants';import{useDispatch}from'react-redux';var libs=['places'];var defaultLocation={lat:45.516,lng:-73.56};export default function MapScreen(props){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),googleApiKey=_useState2[0],setGoogleApiKey=_useState2[1];var _useState3=useState(defaultLocation),_useState4=_slicedToArray(_useState3,2),center=_useState4[0],setCenter=_useState4[1];var _useState5=useState(center),_useState6=_slicedToArray(_useState5,2),location=_useState6[0],setLocation=_useState6[1];var mapRef=useRef(null);var placeRef=useRef(null);var markerRef=useRef(null);useEffect(function(){var fetch=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$Axios,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Axios('/api/config/google');case 2:_yield$Axios=_context.sent;data=_yield$Axios.data;setGoogleApiKey(data);getUserCurrentLocation();case 6:case\"end\":return _context.stop();}}},_callee);}));return function fetch(){return _ref.apply(this,arguments);};}();fetch();},[]);var onLoad=function onLoad(map){mapRef.current=map;};var onMarkerLoad=function onMarkerLoad(marker){markerRef.current=marker;};var onLoadPlaces=function onLoadPlaces(place){placeRef.current=place;};var onIdle=function onIdle(){setLocation({lat:mapRef.current.center.lat(),lng:mapRef.current.center.lng()});};var onPlacesChanged=function onPlacesChanged(){var place=placeRef.current.getPlaces()[0].geometry.location;setCenter({lat:place.lat(),lng:place.lng()});setLocation({lat:place.lat(),lng:place.lng()});};var dispatch=useDispatch();var onConfirm=function onConfirm(){var places=placeRef.current.getPlaces();if(places&&places.length===1){// dispatch select action\ndispatch({type:USER_ADDRESS_MAP_CONFIRM,payload:{lat:location.lat,lng:location.lng,address:places[0].formatted_address,name:places[0].name,vicinity:places[0].vicinity,googleAddressId:places[0].id}});alert('location selected successfully.');props.history.push('/shipping');}else{alert('Please enter your address');}};var getUserCurrentLocation=function getUserCurrentLocation(){if(!navigator.geolocation){alert('Geolocation os not supported by this browser');}else{navigator.geolocation.getCurrentPosition(function(position){setCenter({lat:position.coords.latitude,lng:position.coords.longitude});setLocation({lat:position.coords.latitude,lng:position.coords.longitude});});}};return googleApiKey?/*#__PURE__*/React.createElement(\"div\",{className:\"full-container\"},/*#__PURE__*/React.createElement(LoadScript,{libraries:libs,googleMapsApiKey:googleApiKey},/*#__PURE__*/React.createElement(GoogleMap,{id:\"smaple-map\",mapContainerStyle:{height:'100%',width:'100%'},center:center,zoom:15,onLoad:onLoad,onIdle:onIdle},/*#__PURE__*/React.createElement(StandaloneSearchBox,{onLoad:onLoadPlaces,onPlacesChanged:onPlacesChanged},/*#__PURE__*/React.createElement(\"div\",{className:\"map-input-box\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",placeholder:\"Enter your address\"}),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"primary\",onClick:onConfirm},\"Confirm\"))),/*#__PURE__*/React.createElement(Marker,{position:location,onLoad:onMarkerLoad})))):/*#__PURE__*/React.createElement(LoadingBox,null);}","map":{"version":3,"sources":["C:/Users/gurje/Desktop/new/frontend/src/screens/MapScreen.js"],"names":["React","useEffect","useRef","useState","LoadScript","GoogleMap","StandaloneSearchBox","Marker","LoadingBox","Axios","USER_ADDRESS_MAP_CONFIRM","useDispatch","libs","defaultLocation","lat","lng","MapScreen","props","googleApiKey","setGoogleApiKey","center","setCenter","location","setLocation","mapRef","placeRef","markerRef","fetch","data","getUserCurrentLocation","onLoad","map","current","onMarkerLoad","marker","onLoadPlaces","place","onIdle","onPlacesChanged","getPlaces","geometry","dispatch","onConfirm","places","length","type","payload","address","formatted_address","name","vicinity","googleAddressId","id","alert","history","push","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","height","width"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport {\r\n  LoadScript,\r\n  GoogleMap,\r\n  StandaloneSearchBox,\r\n  Marker,\r\n} from '@react-google-maps/api';\r\nimport LoadingBox from '../components/LoadingBox';\r\nimport Axios from 'axios';\r\nimport { USER_ADDRESS_MAP_CONFIRM } from '../constants/userConstants';\r\nimport { useDispatch } from 'react-redux';\r\n\r\nconst libs = ['places'];\r\nconst defaultLocation = { lat: 45.516, lng: -73.56 };\r\n\r\nexport default function MapScreen(props) {\r\n  const [googleApiKey, setGoogleApiKey] = useState('');\r\n  const [center, setCenter] = useState(defaultLocation);\r\n  const [location, setLocation] = useState(center);\r\n\r\n  const mapRef = useRef(null);\r\n  const placeRef = useRef(null);\r\n  const markerRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    const fetch = async () => {\r\n      const { data } = await Axios('/api/config/google');\r\n      setGoogleApiKey(data);\r\n      getUserCurrentLocation();\r\n    };\r\n    fetch();\r\n  }, []);\r\n\r\n  const onLoad = (map) => {\r\n    mapRef.current = map;\r\n  };\r\n\r\n  const onMarkerLoad = (marker) => {\r\n    markerRef.current = marker;\r\n  };\r\n  const onLoadPlaces = (place) => {\r\n    placeRef.current = place;\r\n  };\r\n  const onIdle = () => {\r\n    setLocation({\r\n      lat: mapRef.current.center.lat(),\r\n      lng: mapRef.current.center.lng(),\r\n    });\r\n  };\r\n  const onPlacesChanged = () => {\r\n    const place = placeRef.current.getPlaces()[0].geometry.location;\r\n    setCenter({ lat: place.lat(), lng: place.lng() });\r\n    setLocation({ lat: place.lat(), lng: place.lng() });\r\n  };\r\n  const dispatch = useDispatch();\r\n  const onConfirm = () => {\r\n    const places = placeRef.current.getPlaces();\r\n    if (places && places.length === 1) {\r\n      // dispatch select action\r\n      dispatch({\r\n        type: USER_ADDRESS_MAP_CONFIRM,\r\n        payload: {\r\n          lat: location.lat,\r\n          lng: location.lng,\r\n          address: places[0].formatted_address,\r\n          name: places[0].name,\r\n          vicinity: places[0].vicinity,\r\n          googleAddressId: places[0].id,\r\n        },\r\n      });\r\n      alert('location selected successfully.');\r\n      props.history.push('/shipping');\r\n    } else {\r\n      alert('Please enter your address');\r\n    }\r\n  };\r\n\r\n  const getUserCurrentLocation = () => {\r\n    if (!navigator.geolocation) {\r\n      alert('Geolocation os not supported by this browser');\r\n    } else {\r\n      navigator.geolocation.getCurrentPosition((position) => {\r\n        setCenter({\r\n          lat: position.coords.latitude,\r\n          lng: position.coords.longitude,\r\n        });\r\n        setLocation({\r\n          lat: position.coords.latitude,\r\n          lng: position.coords.longitude,\r\n        });\r\n      });\r\n    }\r\n  };\r\n\r\n  return googleApiKey ? (\r\n    <div className=\"full-container\">\r\n      <LoadScript libraries={libs} googleMapsApiKey={googleApiKey}>\r\n        <GoogleMap\r\n          id=\"smaple-map\"\r\n          mapContainerStyle={{ height: '100%', width: '100%' }}\r\n          center={center}\r\n          zoom={15}\r\n          onLoad={onLoad}\r\n          onIdle={onIdle}\r\n        >\r\n          <StandaloneSearchBox\r\n            onLoad={onLoadPlaces}\r\n            onPlacesChanged={onPlacesChanged}\r\n          >\r\n            <div className=\"map-input-box\">\r\n              <input type=\"text\" placeholder=\"Enter your address\"></input>\r\n              <button type=\"button\" className=\"primary\" onClick={onConfirm}>\r\n                Confirm\r\n              </button>\r\n            </div>\r\n          </StandaloneSearchBox>\r\n          <Marker position={location} onLoad={onMarkerLoad}></Marker>\r\n        </GoogleMap>\r\n      </LoadScript>\r\n    </div>\r\n  ) : (\r\n    <LoadingBox></LoadingBox>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}